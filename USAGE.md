# BERTopic主题模型分析工具 - 使用指南

## 🎯 项目简介

这是一个基于BERTopic的交互式主题建模分析工具，支持中英文双语界面，提供完整的数据预处理、模型训练、多维度可视化功能，以及完整的结果导出。

## ✨ 主要功能

- 🌐 **中英文双语界面** - 支持界面语言切换
- 📁 **多格式文件支持** - 支持Excel(.xlsx, .xls)和Word(.docx)文件
- 🔧 **完整数据预处理** - 停用词管理、文本清洗、分词处理
- ⚙️ **灵活参数配置** - BERTopic、UMAP、HDBSCAN参数可调
- 📊 **多种可视化选项** - 用户可选择需要的分析项
- 📈 **动态主题分析** - 支持时间序列主题演变分析
- 💾 **完整结果导出** - 支持多种格式导出

## 🚀 快速开始

### 1. 环境要求

- Python 3.8+
- Node.js 16+
- npm 8+

### 2. 安装和启动

```bash
# 克隆项目
git clone <repository-url>
cd bertopic1

# 安装依赖
./install.sh

# 启动服务
./start.sh
```

### 3. 访问应用

- 前端界面: http://localhost:3000
- 后端API: http://localhost:5000

## 📖 详细使用说明

### 步骤1: 文件上传

1. **支持的文件格式**:
   - Excel文件: `.xlsx`, `.xls`
   - Word文件: `.docx`
   - 文件大小限制: 50MB

2. **数据要求**:
   - 至少包含一列文本数据
   - 可选包含时间戳列（用于动态主题分析）
   - 建议文本长度: 50-500字

3. **操作步骤**:
   - 拖拽文件到上传区域或点击选择文件
   - 选择要分析的文本列
   - 选择时间戳列（可选）
   - 预览数据确认无误后点击"下一步"

### 步骤2: 数据预处理

1. **停用词管理**:
   - 系统内置中英文停用词库
   - 支持查看、编辑、添加自定义停用词
   - 可以上传自定义停用词文件

2. **文本清洗选项**:
   - **最小词频阈值**: 过滤低频词（默认2）
   - **最大文档频率阈值**: 过滤高频词（默认0.95）
   - **最小词长限制**: 过滤短词（默认2）
   - **中文分词工具**: jieba/pkuseg/thulac
   - **英文处理**: 词干提取/词形还原
   - **文本清理**: 移除数字、标点、转换为小写

### 步骤3: 参数配置

1. **基础参数**:
   - **最小主题大小**: 主题包含的最少文档数（默认10）
   - **Embedding模型**: 根据文本语言自动推荐

2. **UMAP降维参数**:
   - **邻居数量**: 控制局部与全局结构平衡（默认15）
   - **降维维度**: 降维后的维度数（默认5）
   - **最小距离**: 控制点之间的紧密程度（默认0.0）
   - **距离度量**: cosine/euclidean/manhattan

3. **HDBSCAN聚类参数**:
   - **最小聚类大小**: 聚类的最小大小（默认15）
   - **距离度量**: 计算距离的方法

4. **高级参数**:
   - **主题数量**: 可选，留空则自动确定
   - **关键词数量**: 每个主题显示的关键词数（默认10）
   - **计算概率**: 是否计算文档属于主题的概率

### 步骤4: 选择分析和可视化

**基础分析**（推荐选择）:
- ✅ 主题概览统计
- ✅ 主题分布可视化
- ✅ 主题关键词柱状图

**进阶可视化**:
- ☐ 主题相似度热力图
- ☐ 文档散点图
- ☐ 层级主题结构

**高级分析**:
- ☐ UMAP自定义可视化
- ☐ 层次主题模型
- ☐ 动态主题模型（需要时间戳数据）

### 步骤5: 开始分析

1. **分析过程**:
   - 文本Embedding
   - 降维处理
   - 聚类分析
   - 主题提取
   - 可视化生成

2. **进度显示**:
   - 实时显示当前处理步骤
   - 总体进度条
   - 预估剩余时间

### 步骤6: 结果展示

根据选择的分析项，动态生成对应的Tab页：

- **主题概览**: 统计信息、主题详情表格
- **主题分布**: 2D散点图显示主题分布
- **关键词图表**: 各主题关键词柱状图
- **相似度热力图**: 主题间相似度矩阵
- **文档散点图**: 文档在降维空间的分布
- **层级结构**: 主题层级关系树状图

### 步骤7: 结果导出

1. **导出所有可视化**:
   - ZIP压缩包包含所有HTML交互图表
   - 包含README说明文件

2. **导出带主题标注的数据**:
   - 保留原始数据
   - 添加主题ID、主题名称、关键词等列
   - Excel格式

3. **导出主题详情表**:
   - 多个Sheet的详细分析报告
   - 包含主题统计、关键词矩阵、相似度等

4. **一键导出全部**:
   - 同时导出所有结果

## 🎨 界面功能

### 语言切换
- 右上角语言切换按钮
- 支持中文/English
- 自动检测浏览器语言

### 帮助系统
- 每个模块都有"?"帮助图标
- 点击查看详细说明
- 双语帮助文档

### 响应式设计
- 适配桌面和平板设备
- 现代化UI设计
- 友好的错误提示

## 🔧 技术架构

### 前端技术栈
- React 18
- Material-UI
- React-i18next (国际化)
- Plotly.js (可视化)
- Axios (HTTP请求)

### 后端技术栈
- Flask (Web框架)
- BERTopic (主题建模)
- sentence-transformers (文本嵌入)
- UMAP (降维)
- HDBSCAN (聚类)
- pandas (数据处理)

## 📊 演示数据

项目包含演示数据生成脚本：

```bash
python create_demo_data.py
```

生成的`demo_data.xlsx`包含200个中文文档，涵盖5个主题类别：
- 教育
- 科技  
- 健康
- 经济
- 环境

## 🐛 常见问题

### Q: 分析时间过长怎么办？
A: 可以：
- 减少选择的可视化项
- 降低最小主题大小
- 使用更小的数据集测试

### Q: 内存不足怎么办？
A: 可以：
- 减少文档数量
- 关闭概率计算
- 使用更小的embedding模型

### Q: 主题数量不理想怎么办？
A: 可以：
- 调整最小主题大小
- 调整UMAP和HDBSCAN参数
- 手动设置主题数量

### Q: 中文分词效果不好怎么办？
A: 可以：
- 尝试不同的分词工具
- 添加自定义停用词
- 调整文本清洗参数

## 📝 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 支持中英文双语界面
- 完整的BERTopic分析流程
- 多种可视化选项
- 完整的结果导出功能

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📞 支持

如有问题，请提交Issue或联系开发者。
